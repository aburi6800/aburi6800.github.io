---
layout: post
title:  "【z88dk】C言語/関数(1) 引数の値渡しと参照渡し"
date:   2026-02-09 00:00:00 +0900
categories: z88dk
---

初版 2026/02/09  
改訂  

-----

func1.c

```C
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>

// 値渡し
//   関数内の変数は同名でも呼び出し元に影響しない
//   内部的には引数の変数がスタックに確保され、関数の終了で破棄される
void testFunc_byVal(uint8_t value) {
    value += 2;
}

// 参照渡し
//   与えられたポインタの値を直接更新するため、呼び出し元の変数の値にも反映される
//   対象のアドレスの値を直接操作するイメージ
void testFunc_byRef(uint8_t *value) {
    *value += 2;
}

void main() {

    uint8_t value = 5;

    printf("by val\n");
    testFunc_byVal(value);
    printf("value = %d\n", value);

    printf("by ref\n");
    testFunc_byRef(&value);
    printf("value = %d\n", value);

    return;
}
```

- 関数の引数に変数名を指定すると、値渡しとなる。
- 関数の引数にポインタを指定すると、参照渡しとなる。
- 参照渡しの方が処理速度的に速くなると思われる。（実測はしていない）

<br>

## コンパイル

compile.sh

```shell
#!/bin/sh
zcc +msx -lmsxbios --list -subtype=msxdos $1.c -o $1.com
```

<br>

```shell
$ ./compile.sh ./func1
```

<br>

## 実行結果

![2026-02-09-z88dk-c-func1_01.png](/resources/2026-02-09-z88dk-c-func1_01.png)

※MSXDOS.SYSとCOMMAND.COM、コンパイルして作成した.COMを配置したディレクトリをopenMSXでマウント、MSXDOSから実行
